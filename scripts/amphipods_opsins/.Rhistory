library(tidyr)
library(plyr)
library(ggplot2)
library(plotly)
library(scales)
opsins_only_counts <- read.csv2('/home/alena/Documents/IB/project_opsins/counts_second.csv', sep = ',')
df = read.csv('/home/alena/Documents/IB/project_opsins/stats.csv')
opsins_d_second <- read.csv('/home/alena/Documents/IB/project_opsins/PIA_second_round.txt')
opsins_only_counts$pValue <- factor(opsins_only_counts$pValue)
opsins_only_counts$pValue = revalue(opsins_only_counts$pValue, c("pValue_10^minus10"="E-value = e-10", "pValue_10^minus20"="E-value = e-20"))
colnames(opsins_only_counts) = c('Species', 'count', 'eValue')
ggplot(opsins_only_counts, aes(x = count, fill = eValue)) +
geom_histogram(position="dodge", alpha=0.6, binwidth = 1) +
labs( title = 'Number of opsins` genes identified using different E-values',
y = 'Quantity of transcriptomes',
x = 'Quantity of opsins` genes ') +
scale_x_continuous(breaks= pretty_breaks()) +
scale_fill_manual(values = c('palevioletred4', 'bisque2')) +
theme_classic()
df$Species = as.character(df$Species)
df$Species = as.factor(df$Species)
ggplot(df, aes(fill = Family, x = Species, y = Missing.BUSCOs)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_classic() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
facet_grid(. ~ Family, space = 'free_x', scales = 'free_x') +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) +
scale_fill_manual(values = c("#FF6666", "#999999", "#FF9966", "#00CC99", "#CC3300", "#CC6699", "#336600", "#FFCC66", "#3399CC")) +
labs( title = 'The ratio between transcriptomes` qualities and amphipodes` Families',
y = 'Percents of missing BUSCOs',
x = 'Species')
opsins_d_second$Family = as.factor(opsins_d_second$Family)
ggplot(opsins_d_second, aes(Missing.BUSCOs, E10, colour = Family)) +
geom_point(size = 2) +
scale_y_continuous(breaks= pretty_breaks()) +
labs( title = 'The ratio between transcriptomes` qualities and number of identified opsins` genes (E-value = e-10)',
y = 'Quantity of opsins` genes',
x = 'Percents of missing BUSCOs') +
theme_classic()
opsins_d_second <- read.csv('/home/alena/Documents/IB/project_opsins/github/PIA_both_eValues_results_.csv')
str(opsins_d_second)
opsins_d_second <- read.csv('/home/alena/Documents/IB/project_opsins/github/PIA_both_eValues_results_.csv')
ggplot(opsins_d_second, aes(Missing_BUSCOs, eValue_e.10, colour = Family)) +
geom_point(size = 2) +
scale_y_continuous(breaks= pretty_breaks()) +
labs( title = 'The ratio between transcriptomes` qualities and number of identified opsins` genes (E-value = e-10)',
y = 'Quantity of opsins` genes',
x = 'Percents of missing BUSCOs') +
theme_classic()
ggplot(df, aes(fill = Family, x = Species, y = Missing_BUSCOs)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_classic() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
facet_grid(. ~ Family, space = 'free_x', scales = 'free_x') +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) +
scale_fill_manual(values = c("#FF6666", "#999999", "#FF9966", "#00CC99", "#CC3300", "#CC6699", "#336600", "#FFCC66", "#3399CC")) +
labs( title = 'The ratio between transcriptomes` qualities and amphipodes` Families',
y = 'Percents of missing BUSCOs',
x = 'Species')
ggplot(opsins_d_second, aes(fill = Family, x = Species, y = Missing_BUSCOs)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_classic() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
facet_grid(. ~ Family, space = 'free_x', scales = 'free_x') +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) +
scale_fill_manual(values = c("#FF6666", "#999999", "#FF9966", "#00CC99", "#CC3300", "#CC6699", "#336600", "#FFCC66", "#3399CC")) +
labs( title = 'The ratio between transcriptomes` qualities and amphipodes` Families',
y = 'Percents of missing BUSCOs',
x = 'Species')
#opsins_only_counts <- read.csv2('/home/alena/Documents/IB/project_opsins/github/PIA_both_eValues_results.csv', sep = ',')
df = read.csv('/home/alena/Documents/IB/project_opsins/github/PIA_eValue_e-10_stats.csv')
#opsins_only_counts <- read.csv2('/home/alena/Documents/IB/project_opsins/github/PIA_both_eValues_results.csv', sep = ',')
df = read.csv('/home/alena/Documents/IB/project_opsins/github/PIA_eValue_e-10_results.csv')
str(df)
opsins_d_second$Family =as.factor(as.character(opsins_d_second$Family))
str(opsins_d_second)
opsins_d_second <- read.csv('/home/alena/Documents/IB/project_opsins/github/PIA_both_eValues_results_.csv')
#opsins_only_counts$pValue <- factor(opsins_only_counts$pValue)
str(opsins_d_second)
ggplot(opsins_d_second, aes(fill = Family, x = Species, y = Missing_BUSCOs)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_classic() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
facet_grid(. ~ Family, space = 'free_x', scales = 'free_x') +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) +
scale_fill_manual(values = c("#FF6666", "#999999", "#FF9966", "#00CC99", "#CC3300", "#CC6699", "#336600", "#FFCC66", "#3399CC")) +
labs( title = 'The ratio between transcriptomes` qualities and amphipodes` Families',
y = 'Percents of missing BUSCOs',
x = 'Species')
df = read.csv('/home/alena/Documents/IB/project_opsins/github/PIA_both_eValues_results_.csv')
ggplot(df, aes(fill = Family, x = Species, y = Missing_BUSCOs)) +
geom_bar(stat = 'identity', position = 'dodge') +
theme_classic() +
theme(axis.text.x=element_blank(),
axis.ticks.x=element_blank()) +
facet_grid(. ~ Family, space = 'free_x', scales = 'free_x') +
theme(
strip.background = element_blank(),
strip.text.x = element_blank()
) +
scale_fill_manual(values = c("#FF6666", "#999999", "#FF9966", "#00CC99", "#CC3300", "#CC6699", "#336600", "#FFCC66", "#3399CC")) +
labs( title = 'The ratio between transcriptomes` qualities and amphipodes` Families',
y = 'Percents of missing BUSCOs',
x = 'Species')
ggplot(df, aes(Missing_BUSCOs, eValue_e.10, colour = Family)) +
geom_point(size = 2) +
scale_y_continuous(breaks= pretty_breaks()) +
labs( title = 'The ratio between transcriptomes` qualities and number of identified opsins` genes (E-value = e-10)',
y = 'Quantity of opsins` genes',
x = 'Percents of missing BUSCOs') +
theme_classic()
View(df)
df_cut = df[,1,2,3]
df_cut = df[,1:3]
View(df_cut)
df1 = df_cut %>% gather(key = Opsins,value = eValue,-Species)
View(df1)
df1 = df_cut %>% gather(key = eValue,value = Opsins,-Species)
ggplot(df1, aes(x = Opsins, fill = eValue)) +
geom_histogram(position="dodge", alpha=0.6, binwidth = 1) +
labs( title = 'Number of opsins` genes identified using different E-values',
y = 'Quantity of transcriptomes',
x = 'Quantity of opsins` genes ') +
scale_x_continuous(breaks= pretty_breaks()) +
scale_fill_manual(values = c('palevioletred4', 'bisque2')) +
theme_classic()
ggplot(df1, aes(x = Opsins, fill = eValue)) +
geom_histogram(position="dodge", alpha=0.6, binwidth = 1) +
labs( title = 'Number of opsins` genes identified using different E-values',
y = 'Quantity of transcriptomes',
x = 'Quantity of opsins` genes ') +
scale_x_continuous(breaks= pretty_breaks()) +
scale_fill_manual(values = c('palevioletred4', 'bisque2')) +
theme_classic()
knitr::opts_chunk$set(echo = TRUE)
df = read.csv('/data/PIA_both_eValues_results.csv')
